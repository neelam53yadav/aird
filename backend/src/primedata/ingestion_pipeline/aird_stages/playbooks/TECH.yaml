id: TECH
description: Technical/engineering docs (how-tos, best practices, architecture, APIs)

probes:
  must_match:
    - '(?i)\b(best\s+practices|architecture|design\s+principles|overview|get(?:ting)?\s+started|api|sdk|guide|tutorial|deployment|observability|security)\b'
  nice_to_have:
    - '(?mi)^#{1,3}\s+.+$'                  # Markdown ATX headings
    - '(?mi)^\d+(?:\.\d+)*\s+.+$'           # Numbered headings
    - '(?mi)^\*\s+.+$'                      # Bulleted lists
    - '(?m)^[-*+]\s+.+$'                    # Other bullets
    - '```'                                 # Code fences
  must_match_flags: IGNORECASE
  nice_to_have_flags: MULTILINE

pre_normalizers:
  # Hygiene + OCR/Markdown cleanup
  - pattern: "\u00AD"                        # soft hyphen
    replace: ''
  - pattern: "[\u2018\u2019]"               # smart single quotes → '
    replace: "'"
  - pattern: "[\u201C\u201D]"               # smart double quotes → "
    replace: '"'
  - pattern: "[\u2013\u2014]"               # en/em dash → hyphen
    replace: "-"
  - pattern: '(?m)([A-Za-z])-[ \t]*\r?\n[ \t]*([A-Za-z])'   # de-hyphenate across lines
    replace: '\1\2'
  - pattern: '(?m)\r?\n(?=[a-z])'           # join lowercase-leading continuation lines
    replace: ' '
  - pattern: '(?m)^\s{1,4}\|\s?'            # stray table/pipe prefixes
    replace: ''
  - pattern: '(?m)^\s*[›»]\s*'              # fancy callout markers
    replace: ''
  - pattern: '(?m)^\s*—\s*'                 # em-dash callout
    replace: '- '
  - pattern: '(?m)^\s*\*\s*\*\s*\*\s*$'     # hr separators
    replace: ''
  - pattern: '(?mi)^\s*Page\s+\d+\s+of\s+\d+\s*$'  # page headers/footers
    replace: ''
  - pattern: '(?m)^[ \t]+$'                 # blank indent-only lines
    replace: ''
  - pattern: '[ \t]{2,}'
    replace: ' '
  # Reduce mid-sentence hard wraps (keep blank-line paragraph breaks)
  - pattern: '(?m)(?<![.!?])\r?\n(?!\r?\n|[#*\-+`])'
    replace: ' '

page_fences:
  - pattern: '^[ \t\|]*=== PAGE \d+ ===[ \t\|]*$'
    flags: MULTILINE
  - pattern: '(?:\f|\x0c)'
    flags: MULTILINE
  - pattern: '(?mi)^\s*Page\s+\d+\s+of\s+\d+\s*$'
    flags: MULTILINE

headers:
  - pattern: '^(?:#{1,6})\s+.+$'            # Markdown ATX
    flags: MULTILINE
  - pattern: '^.+\r?\n[-=]{3,}\s*$'         # Markdown Setext (=== or --- underline)
    flags: MULTILINE
  - pattern: '^(\d+(?:\.\d+)*)\s+.+$'       # 1 / 1.1 / 2.3.4 style
    flags: MULTILINE
  - pattern: '^(?:[A-Z][A-Z0-9 &''''\-/,:\(\)]+)$'  # SHOUTY HEADERS
    flags: MULTILINE

section_aliases:
  Introduction: introduction
  Overview: overview
  "Getting Started": getting_started
  Architecture: architecture
  "Reference Architecture": architecture
  "Design Principles": design_principles
  "Best Practices": best_practices
  Implementation: implementation
  Configuration: configuration
  Installation: installation
  Deployment: deployment
  "CI/CD": cicd
  API: api
  "API Reference": api
  SDK: sdk
  CLI: cli
  Security: security
  Compliance: compliance
  RBAC: security
  Observability: observability
  Monitoring: monitoring
  Operations: ops
  Performance: performance
  Scalability: scalability
  Tuning: performance
  Limitations: limitations
  Troubleshooting: troubleshooting
  FAQ: faq
  Glossary: glossary
  Roadmap: roadmap
  Appendix: appendix

audience_rules:
  - pattern: '(?i)\b(api|sdk|code|cli|endpoint|request|response|json|yaml|protobuf|grpc)\b'
    audience: dev
  - pattern: '(?i)\b(security|compliance|encryption|rbac|acl|sso|oauth|oidc|key rotation|kms)\b'
    audience: security
  - pattern: '(?i)\b(monitoring|deployment|scaling|ops|slo|sla|observability|kubernetes|helm|terraform|ansible)\b'
    audience: ops
  - pattern: '(?i)\b(overview|introduction|benefits|executive|summary|roadmap)\b'
    audience: exec
  - pattern: '(?i)\b(how to|tutorial|walkthrough|get(?:ting)?\s+started)\b'
    audience: general

chunking:
  # sentence-first; fallback in code blocks handled by char-split at preprocess layer
  strategy: sentence
  max_tokens: 800
  overlap_sentences: 1
  hard_overlap_chars: 240

quality_gates:
  min_sections: 3
  max_mid_sentence_boundary_rate: 0.15

# Noise detection patterns for Noise Ratio metric
noise_patterns:
  boilerplate:
    - pattern: '(?i)^\s*(confidential|proprietary|copyright|all rights reserved)'
      flags: MULTILINE
    - pattern: '(?i)^\s*page\s+\d+\s+of\s+\d+\s*$'
      flags: MULTILINE
  navigation:
    - pattern: '(?i)^\s*(table of contents|index|appendix)\s*$'
      flags: MULTILINE

# Chunk coherence settings for Coherence Score
coherence:
  method: embedding_similarity
  min_coherence_threshold: 0.6
  sentence_window: 3

# RAG evaluation settings for synthetic query generation
rag_evaluation:
  query_generation:
    queries_per_chunk: 3
    query_style: technical
    include_context: true
    min_query_length: 10
    max_query_length: 50
  retrieval_settings:
    top_k: 10
    similarity_threshold: 0.7




